2011-09-09T23:10:00.000Z	mbeierl		Very interesting.  twice now, my home gateway ubuntu box has had an IRC bot installed on it.  does anyone know if there are any  vulnerabilities in Natty?
2011-09-09T23:10:00.000Z	mbeierl		the first time, someone actually managed to install an ssh key in .ssh to allow passwordless access.
2011-09-09T23:11:00.000Z	yeats	mbeierl	sounds like you need to lock down SSH
2011-09-09T23:12:00.000Z	yeats	mbeierl	check /var/log/auth.log to see if anyone is ssh-ing in
2011-09-09T23:12:00.000Z	mbeierl	yeats	but the question is... how are they getting in there.  Nope.  I can't see anything there.  This script put a cron entry in: */5 * * * * /var/tmp/.tmp/.Driver/driver.cron > /dev/null 2>&1
2011-09-09T23:13:00.000Z	yeats	mbeierl	I would check open ports and make sure your firewall is blocking what you need it to
2011-09-09T23:14:00.000Z	yeats		!info rkhunter | mbeierl
2011-09-09T23:15:00.000Z	mbeierl	yeats	thanks.  The thing is, I've already done this once.  I don't get how they got back in...
2011-09-09T23:15:00.000Z	yeats	mbeierl	I would scour the logs for more info
2011-09-09T23:24:00.000Z	mbeierl	yeats	this is not necessarily a rootkit, though.  It's just a script run as a user process that "hides" itself in a directory called "...".  Would rkhunter search for user-level bots/scripts?
2011-09-09T23:25:00.000Z	yeats	mbeierl	I would run it and see what it finds
2011-09-09T23:28:00.000Z	mbeierl	yeats	did.  it found nothing :(
2011-09-09T23:30:00.000Z	yeats	mbeierl	ok, so I would just do my best to figure out *when* the files/scripts were created and try to correlate the create/edit times with logs
2011-09-09T23:31:00.000Z	yeats	mbeierl	do an nmap against your server to see which ports are open and adjust your firewall accordingly
2011-09-09T23:31:00.000Z	yeats	mbeierl	you could also disable password login with SSH and just use ssh keys (since you said that was a vulnerablity before)
2011-09-09T23:31:00.000Z	mbeierl	yeats	already done.  nothing that should not be there
2011-09-09T23:32:00.000Z	yeats	mbeierl	that's about all the advice *I* have - maybe someone else in the channel has some ideas
2011-09-09T23:32:00.000Z	mbeierl	yeats	no, it was an ssh key that was put in place by something that allowed the first bot to be installed.  I don't get how on earth an external key could have gotten onto my system
