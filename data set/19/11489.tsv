2006-07-01T14:48:00.000Z	dooglus	vlt	there's a package called 'simpleproxy' which can do what you want.  you can probably configure iptables to do it too, but I don't know how
2006-07-01T14:49:00.000Z	vlt	dooglus	Thank you. I'll have a look ...
2006-07-01T14:49:00.000Z	dooglus	vlt	port forwarding xxx.xxx.xxx.xxx:8888 to 192.168.0.2:80 .
2006-07-01T14:49:00.000Z	dooglus		/sbin/iptables -t nat -A PREROUTING -p tcp -i eth0 -d xxx.xxx.xxx.xxx --dport 8888 -j DNAT --to 192.168.0.2:80
2006-07-01T14:49:00.000Z	dooglus		/sbin/iptables -A FORWARD -p tcp -i eth0 -d 192.168.0.2 --dport 80 -j ACCEPT
2006-07-01T14:53:00.000Z	vlt	dooglus	Cool. Trying ...
2006-07-01T14:57:00.000Z	vlt	dooglus	simpleproxy works. Now trying just the iptables lines ...
2006-07-01T14:57:00.000Z	dooglus	vlt	I just tried it, and can't get it working.
2006-07-01T14:58:00.000Z	vlt	dooglus	simpleproxy or iptables?
2006-07-01T14:58:00.000Z	dooglus	vlt	iptables
2006-07-01T14:58:00.000Z	vlt	dooglus	Maybe the answers don't fins their way ...
2006-07-01T14:58:00.000Z	vlt	dooglus	find
2006-07-01T14:58:00.000Z	dooglus	vlt	I copied it from http://www.hackorama.com/network/portfwd.shtml - but maybe that's only for the 2.4 kernel?
2006-07-01T14:59:00.000Z	vlt		dooglus:No, I don't think there's such a big difference.
2006-07-01T15:00:00.000Z	dooglus	vlt	maybe it failed like the last paragraph says it will: "The above rules work fine when you access from outside, but if you try to access the same port xxx.xxx.xxx.xxx:8888 from an internal machine, it will not work." - I used the local machine to test it
2006-07-01T15:00:00.000Z	vlt	dooglus	Then packets dont run through PREROUTING I think
2006-07-01T15:01:00.000Z	dooglus	vlt	see also: http://www.computing.net/linux/wwwboard/forum/27126.html
2006-07-01T15:06:00.000Z	vlt	dooglus	I tested with just the first line: I connect from A, iptables runs on B and does the forwarding to C. The packets reach C  (I can watch with iptables logging there) and have the source address of A, so I think there's some additional masquerading needed ....
2006-07-01T15:09:00.000Z	vlt	dooglus	It works!!! I added "iptables -t nat -A POSTROUTING -o tun1 -j MASQUERADE" and now the packets arriving on C have source IP of B, and B sends C's answers back to A   :-))
