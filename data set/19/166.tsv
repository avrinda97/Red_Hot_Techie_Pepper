2012-07-26T08:09:00.000Z	JeremyA		Well I just had something VERY strange and scary happen. I opened aptitude on my 12.04 LTS Server install, press U to update the cache, then selected the Upgradable Packages and Security Updates category and hit Go.
2012-07-26T08:10:00.000Z	JeremyA		I came back a little later, hit enter and was surprised to see the Updates/Upgrades categories still had packages
2012-07-26T08:10:00.000Z	JeremyA		So I selected them again and hit Go
2012-07-26T08:10:00.000Z	JeremyA		This time the procedure immediately failed with a dpkg error about removing sudo being forbidden. I then went back and saw that the removal list had sudo in it for some reason.
2012-07-26T08:11:00.000Z	JeremyA		I opened up /var/log/aptitude and I now see that aptitude just removed about 200 packages seemingly at random, deeming them unused.
2012-07-26T08:11:00.000Z	JeremyA		This includes packages like 'time'
2012-07-26T08:12:00.000Z	jrib	JeremyA	umm, are you using multi-arch?
2012-07-26T08:14:00.000Z	jrib	JeremyA	yes/no?
2012-07-26T08:14:00.000Z	JeremyA	jrib	The install is 64-bit
2012-07-26T08:15:00.000Z	jrib	JeremyA	did you install 12.04 fresh?  What's in /etc/dpkg/dpkg.cfg.d/multiarch?
2012-07-26T08:15:00.000Z	JeremyA	jrib	I did a dist-upgrade from 11.04 if I remember correctly
2012-07-26T08:16:00.000Z	jrib	JeremyA	if you read release notes for 12.04 (and I believe this has existed for previous releases as well), aptitude is broken with multi-arch.  So you shouldn't use it if you are using multi-arch (which it seems you are)
2012-07-26T08:17:00.000Z	jrib	JeremyA	no, multi-arch allows you to install packages of different architectures. For example, installing i386 packages on an amd64 system
2012-07-26T08:17:00.000Z	JeremyA	jrib	So just by installing libc32 or whatever it was, it set this up to happen
2012-07-26T08:18:00.000Z	jrib	JeremyA	I don't know
2012-07-26T08:20:00.000Z	JeremyA	jrib	My thought was to parse that log and run the list of packages through apt-get install. Is there any reason why that wouldn't work?
2012-07-26T08:20:00.000Z	jrib	JeremyA	I guess that's fine, just read what it's going to do before agreeing
2012-07-26T08:28:00.000Z	JeremyA	jrib	Thanks for the help. I've been using aptitude for ages. I never suspected it could fuck up this badly!
2012-07-26T08:28:00.000Z	jrib	JeremyA	yes, I'm saddened by this bug as well...
