2008-05-16T01:08:00.000Z	Annirak		So I'm setting up an iptables forward for port 443 to a network appliance at local address 192.168.120.7:443.  My rule is simple: iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 443 -j DNAT --to 192.168.120.7:443    When I do an nmap from the gateway box, (nmap 192.168.120.7 -p 443), I get an open port.  When I do an nmap remotely, I get filtered.  What am I doing wrong?
2008-05-16T01:09:00.000Z	Lynet	Annirak	Is eth1 your wan interface?
2008-05-16T01:10:00.000Z	Annirak	Lynet	Yes
2008-05-16T01:11:00.000Z	Annirak	Lynet	eth0=slow-wan, eth1=fastwan, eth2=lan
2008-05-16T01:18:00.000Z	Lynet	Annirak	Are you sure packets from outside arrive at fastwan and not slow-wan?
2008-05-16T01:19:00.000Z	Annirak	Lynet	Positive.  I'm using the fastwan IP directly
2008-05-16T01:22:00.000Z	Lynet	Annirak	Hmm.. Does logs/tcpdump show that the nat box drops the packets instead of forwarding them?
2008-05-16T01:24:00.000Z	Annirak	Lynet	"find / -iname tcpdump" returns no results
2008-05-16T01:25:00.000Z	Lynet	Annirak	Well, rule looks fine so I'm thinking there might be something else screwy. Does the appliance have default gateway set correctly?
2008-05-16T01:28:00.000Z	Annirak	Lynet	I have no idea.  The other ports I have forwarded appear to work.  I'm also forwarding 5002,5003 to the appliance, both are open both in and outside.
2008-05-16T01:29:00.000Z	Annirak	Lynet	I am forwarding port 431 as well.  It's closed inside, but shows up as filtered outside.  Could it be something to do with the port being a low-numbered port?
2008-05-16T01:29:00.000Z	Lynet	Annirak	Hmm, if other ports work fine from outside then it isn't a routing issue. Could be some firewall rules interfering?
2008-05-16T01:32:00.000Z	Annirak	Lynet	Really basic firewall.  I actually don't even have a drop rule in place yet.
2008-05-16T01:34:00.000Z	Lynet	Annirak	Could you pastebin your iptables --list?
2008-05-16T01:35:00.000Z	Annirak	Lynet	http://pastebin.com/d29d0df90
2008-05-16T01:42:00.000Z	Lynet	Annirak	Sorry, not really sure what the problem is. It looks like it should work, but it doesn't.
2008-05-16T01:42:00.000Z	Annirak	Lynet	well, thanks for the help
2008-05-16T01:43:00.000Z	Lynet	Annirak	I'd try doing a couple network traces though, the error might be elsewhere.
2008-05-16T01:44:00.000Z	Annirak	Lynet	I don't know how to do that
