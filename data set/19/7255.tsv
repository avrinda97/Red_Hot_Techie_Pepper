2007-10-10T16:19:00.000Z	heguru	tsurc	actually i believe you can
2007-10-10T16:20:00.000Z	heguru	tsurc	there is a match module --match owner --gid <grouname> that will match all traffic generated by the specified group
2007-10-10T16:20:00.000Z	heguru	tsurc	that can then be redirected to port 8080
2007-10-10T16:21:00.000Z	tsurc	heguru	its getting the syntax right though. Its got to that time of day that I just cant see the wood for the trees
2007-10-10T16:23:00.000Z	heguru	tsurc	the rule will be something like this: iptables -t nat -A PREROUTING -p tcp --match owner --gid-owner guest -j REDIRECT --to-port 8080
2007-10-10T16:28:00.000Z	tsurc	heguru	na I'm getting invalid argument, any idea how I can debug it?
2007-10-10T16:29:00.000Z	heguru	tsurc	it might be that --gid-owner only takes numeric group ids, run getent group | grep guest and use the numeric id
2007-10-10T16:30:00.000Z	tsurc	heguru	one step ahead of you I'd done that already. same result both times
2007-10-10T16:30:00.000Z	heguru	tsurc	ok let me try it myself first
2007-10-10T16:31:00.000Z	heguru	tsurc	its --redirect-ports 8080
2007-10-10T16:31:00.000Z	heguru	tsurc	--to-ports 8080
2007-10-10T16:33:00.000Z	tsurc	heguru	"iptables v1.3.6: Unknown arg `--redirect-ports'"
2007-10-10T16:33:00.000Z	heguru	tsurc	one min
2007-10-10T16:35:00.000Z	heguru	tsurc	 iptables -t nat -A OUTPUT -p tcp --match owner --gid-owner 1000 -j REDIRECT --to-ports 8080
2007-10-10T16:35:00.000Z	heguru	tsurc	just verified, it works too
2007-10-10T16:36:00.000Z	heguru	tsurc	in your case 8080 might be 3128
2007-10-10T16:37:00.000Z	tsurc	heguru	yup worked here too, now I'm hoping that those pesky kids won't be able to circumnavigate it. edubuntu gutsy + squid + dansguardian + iptable = one kick ass terminal server
2007-10-10T16:38:00.000Z	heguru	tsurc	lols, well i doubt that, kids can bypass any type of protection!, instead of trying to block, I would rather just LOG every connection
2007-10-10T16:38:00.000Z	tsurc	heguru	thanks for your help. me thinks I'll be writting it up somewhere on the edubuntu wiki. and add logging too
